<app-navigation />

<main class="container">
  <section class="banner">
    <div class="banner-inner">
      <div>
        <div class="title">Charity & Causes events</div>
        <div class="sub-title">Welcome — together, we can make a difference.</div>
        <div class="sub-title">Discover the best Charity & Causes events in your area and online</div>
      </div>
      <img class="charity-img" src="/images/charity_and_causes.webp" alt="Charity And Causes" />
    </div>
  </section>

  <section class="charity-and-causes">
    <div class="card">
      <h1 class="h2" style="margin-top:0;">Search events</h1>
      <p class="muted" style="margin-top:4px;">Filter by date range, city, and category.</p>

      <form id="search-form" class="form" (ngSubmit)="submit()">
        <div class="form-row">
          <label for="date_from">Date from</label>
          <input id="date_from" name="date_from" type="date" [(ngModel)]="searchForm.date_from" />
        </div>
        <div class="form-row">
          <label for="date_to">Date to</label>
          <input id="date_to" name="date_to" type="date" [(ngModel)]="searchForm.date_to" />
        </div>
        <div class="form-row">
          <label for="city">City</label>
          <input id="city" name="city" type="text" placeholder="e.g. Sydney" [(ngModel)]="searchForm.city" />
        </div>
        <div class="form-row">
          <label for="category_id">Category</label>
          <select id="category_id" name="category_id" [(ngModel)]="searchForm.category">
            <option value="">-- All --</option>
            <option *ngFor="let category of categories" [value]="category.id">{{category.name}}</option>
          </select>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn">Search</button>
          <button type="button" id="btn-clear" class="btn" (click)="clearSearch()">Clear</button>
        </div>
      </form>
    </div>

    <div style="margin-top: 20px;">
      <div class="row-between">
        <h2 class="h2">Results</h2>
        <span id="result-count" class="pill">{{this.events.length + (this.events.length === 1 ? ' event' : ' events')}}</span>
      </div>

      <div *ngIf="showListLoading" id="list-loading" class="notice">Searching…</div>
      <div *ngIf="showListError" id="list-error" class="notice error">Sorry, something went wrong.</div>
      <div *ngIf="showListEmpty" id="list-empty" class="notice">No events matched your filters.</div>

      <div id="cards" class="cards">
        <article class="card" *ngFor="let event of events">
          <img class="thumb" [alt]="event.name" [src]="event.image_url || '/images/event_placeholder.jpg'">
          <div class="card-body">
            <div class="meta">
              <span class="badge badge-{{getStatus(event)}}">{{getStatus(event)}}</span>
              <span>{{ event.start_datetime | date:'medium'  }}</span>
              <span>{{ event.location_city || '-' }}</span>
            </div>
            <div class="title">{{event.name}}</div>
            <a class="btn" [routerLink]="'/details/' + event.id">View details</a>
          </div>
        </article>
      </div>
    </div>
  </section>

</main>
